<html><head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
        <script type="text/javascript" src="js/jquery.qrcode-0.12.0.js"></script>
        <script type="text/javascript" src="http://netdna.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="js/chess.js"></script>
        <script type="text/javascript" src="js/chessboard-0.3.0.js"></script>
        <link href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href="styles/site.css" rel="stylesheet" type="text/css">
        <link href="styles/custom.css" rel="stylesheet" type="text/css">
        <link href="styles/chessboard-0.3.0.css" rel="stylesheet" type="text/css">
    </head><body>
        <div class="navbar navbar-default navbar-static-top">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-ex-collapse">
                <span class="sr-only">Menu</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
            </div>
            <a class="navbar-brand" href="#"><img src="img/logo/name_large_transp.png" width="210"></a>
            <div class="collapse navbar-collapse menu" id="navbar-ex-collapse">
              <ul class="nav navbar-nav navbar-right">
                  <li>
                      <a href="index.html">HOME</a>
                  </li>
                  <li>
                      <a href="howitworks.html">HOW IT WORKS?</a>
                  </li>
                  <li>
                      <a href="fen.html">FEN</a>
                  </li>
                  <li class="active">
                      <a href="pgn.html">PGN</a>
                  </li>
                  <li>
                      <a href="contact.html">CONTACT</a>
                  </li>
              </ul>
            </div>
          </div>
        </div>

        <div class="section">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                      <div class="row">
                          <div class="col-md-1"></div>
                        <div class="col-md-3 text-right">
                            <div class="row"><h4 id="status"></h4></div>

                        </div>
                        <div class="col-md-4 text-center"><div id="board" style="width: 100%"></div></div>
                        <div class="col-md-2 text-left">
                          <div class="row">
                              <div class="text-left">
                                <div class="text-center">
                                  <label>Promote to</label>
                                </div>
                              <ul class="list-group">
                                <span id="promotionChoiceGroup">
                                  <li class="list-group-item">
                                    <label>
                                      <input type="radio" name="promotionChoice" value="q" checked=""> Queen</label>
                                  </li>
                                  <li class="list-group-item">
                                    <label>
                                      <input type="radio" name="promotionChoice" value="r"> Rook</label>
                                  </li>
                                  <li class="list-group-item">
                                    <label>
                                      <input type="radio" name="promotionChoice" value="b"> Bishop</label>
                                  </li>
                                  <li class="list-group-item">
                                    <label>
                                      <input type="radio" name="promotionChoice" value="n"> Knight</label>
                                  </li>
                                </span>
                              </ul>
                              </div>
                          </div>
                          <div class="text-left">
                              <div class="row"><h4>PGN:</h4></div>
                              <div class="row"><textarea class="form-control" rows="3" id="pgn" readonly=""></textarea></div>
                          </div>

                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="container">
                    <div class="row top-buffer">
                    <div class="col-md-12">
                      <div class="col-md-3"></div>
                      <div class="col-md-6 text-center"><canvas class="img-responsive" style="display: initial" width="300" height="300" id="qrcode"></canvas></div>
                      <div class="col-md-3"></div>
                    </div>
                </div>
            </div>
          </div>
          <footer class="section section-custom">
            <div class="container">
              <div class="row">
                <div class="col-sm-6">
                  <img src="img/logo/name_large_transp.png" class="img-responsive" width="380">
                  <p>Diagram Club is an app and a website, made with <a href="http://diagramclub.github.io/img/assets/love.png" target="_blank" class="linkedLight">love</a> using wonderful libraries
                    like <a href="https://github.com/official-stockfish" target="_blank" class="linkedLight">Stockfish UCI Chess Engine</a>, <a href="http://chessboardjs.com/" target="_blank" class="linkedLight">ChessBoard.JS</a>, <a href="https://github.com/jhlywa/chess.js" target="_blank" class="linkedLight">Chess.JS</a>,
                    and others.</p>
                </div>
                <div class="col-sm-6">
                  <p class="text-info text-right">
                    <br>
                    <br>
                  </p>
                  <div class="row">
                    <div class="col-md-12 hidden-lg hidden-md hidden-sm text-left">
                      <a href="https://www.instagram.com/diagramclub/"><i class="fa fa-3x fa-fw fa-instagram text-inverse"></i></a>
                      <a href="https://twitter.com/diagramclub"><i class="fa fa-3x fa-fw fa-twitter text-inverse"></i></a>
                      <a href="http://facebook.com/diagramclub"><i class="fa fa-3x fa-fw fa-facebook text-inverse"></i></a>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-md-12 hidden-xs text-right">
                      <a href="https://www.instagram.com/diagramclub/"><i class="fa fa-3x fa-fw fa-instagram text-inverse"></i></a>
                      <a href="https://twitter.com/diagramclub"><i class="fa fa-3x fa-fw fa-twitter text-inverse"></i></a>
                      <a href="http://facebook.com/diagramclub"><i class="fa fa-3x fa-fw fa-facebook text-inverse"></i></a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </footer>
          <img id="img-buffer" src="img/assets/name_qrcode.png">
</body>
<script>



      var board,
         game = new Chess(),
         statusEl = $('#status'),
         fenEl = $('#fen'),
         pgnEl = $('#pgn'),
         imgPgn = $('#imgPgn')
         promotionChoice = "q";

         $("input[name=promotionChoice]").click(function(){
             promotionChoice = $('input[name=promotionChoice]:checked', '#promotionChoiceGroup').val();
         });

         var removeGreySquares = function() {
           $('#board .square-55d63').css('background', '');
         };

         var greySquare = function(square) {

            var squareEl = $('#board .square-' + square);

            var background = 'rgba(241, 218, 14, 0.52)';
            if (squareEl.hasClass('black-3c85d') === true) {
              background = 'rgba(241, 218, 14, 0.39)';
            }

            squareEl.css('background', background);
            squareEl.addClass('taphover');
          };

         var onMouseoverSquare = function(square, piece) {
           // get list of possible moves for this square
           var moves = game.moves({
             square: square,
             verbose: true
           });

           // exit if there are no moves available for this square
           if (moves.length === 0) return;

           // highlight the square they moused over
           greySquare(square);

           // highlight the possible squares for this piece
           for (var i = 0; i < moves.length; i++) {
             greySquare(moves[i].to);
           }
         };

         var onMouseoutSquare = function(square, piece) {
            removeGreySquares();
         };

         // do not pick up pieces if the game is over
         // only pick up pieces for the side to move
         var onDragStart = function(source, piece, position, orientation) {
           if (game.game_over() === true ||
           (game.turn() === 'w' && piece.search(/^b/) !== -1) ||
           (game.turn() === 'b' && piece.search(/^w/) !== -1)) {
             return false;
           }
         };

         var onDrop = function(source, target) {

           removeGreySquares();
           // see if the move is legal
           var move = game.move({
             from: source,
             to: target,
             promotion: promotionChoice // NOTE: always promote to a queen for example simplicity
           });

           // illegal move
           if (move === null) return 'snapback';

           updateStatus();
         };

         // update the board position after the piece snap
         // for castling, en passant, pawn promotion
         var onSnapEnd = function() {
           board.position(game.fen());
         };

         var updateStatus = function() {
           var status = '';

           var moveColor = 'White';
           if (game.turn() === 'b') {
             moveColor = 'Black';
           }

           // checkmate?
           if (game.in_checkmate() === true) {
             status = 'Game over, ' + moveColor + ' is in checkmate.';
           }

           // draw?
           else if (game.in_draw() === true) {
             status = 'Game over, drawn position';
           }

           // game still on
           else {
             status = moveColor + ' to move';

             // check?
             if (game.in_check() === true) {
               status += ', ' + moveColor + ' is in check';
             }
           }

           statusEl.html(status);
           fenEl.attr('value',game.fen());
           pgnEl.val(game.pgn());
           if(pgnEl.length)
             pgnEl.scrollTop(pgnEl[0].scrollHeight - pgnEl.height());

           if (game.pgn())
             createQR(game.pgn());
         };

         var createQR = function(string){
             $('#qrcode').empty().qrcode({
                 // https://larsjung.de/jquery-qrcode/
                 render: 'image',
                 ecLevel: 'Q',
                 size: 300,
                 fill: '#2d3e4e',
                 mode: 4,
                 mSize: 0.1,
                 radius: 0.5,
                 quiet: 0,
                 text: string,
                 image: $('#img-buffer')[0]
                 });
         };

         var cfg = {
           pieceTheme: 'img/chesspieces/alpha/{piece}.png',
           draggable: true,
           position: 'start',
           onDragStart: onDragStart,
           onDrop: onDrop,
           onSnapEnd: onSnapEnd,
           onMouseoutSquare: onMouseoutSquare,
           onMouseoverSquare: onMouseoverSquare
         };
         board = ChessBoard('board', cfg);
         $(window).resize(board.resize);
         updateStatus();


</script>
</html>
